# Sniffing and spoofing


## Sniffing
```python
from scapy.all import *

def printPacket(iPacket):
    iPacket.show()

packet = sniff(iface="eth0",filter="icmp",prn=printPacket)
```

If multiple interfaces :
```python
iface=["eth0","wlan0"]
```

## Spoofing ICMP Packets

```python
ip = IP()
ip.dst = "10.0.0.1"
icmp = ip/ICMP()

sendp(icmp)
```

## Traceroute

```python
a = IP()
a.dst = "10.0.0.1"
a.ttl = 3
b = ICMP()

send(a/b)
```